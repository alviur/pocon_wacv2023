from tests import run_main_and_assert

# ================================ Redoo copy ===================================#
# R18-R18
# 4 tasks filigreed-rooster-870
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 256  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 500   --linearProj 3 --linearProjRet 4 --lrExpF 1"
# 10 tasks prosperous-festival-873
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 256  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 500   --linearProj 3 --linearProjRet 4 --lrExpF 1"
# 20 tasks beaming-dog-874
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 03 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 256  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 500   --linearProj 3 --linearProjRet 4 --lrExpF 1"
# 50 tasks virtuous-firecracker-875
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 04 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 50 --seed 667 --batch_size 256  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 500   --linearProj 3 --linearProjRet 4 --lrExpF 1"
# 50 tasks 500 batch
# /data/users/agomezvi/tiny_imagenet_copyOP_tiny_epochs-01272023_104509_502691
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-1 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 250   --linearProj 3 --linearProjRet 4 --lrExpF 1"
# 500  896
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-1 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 500   --linearProj 3 --linearProjRet 4 --lrExpF 1"
# brilliant-lamp-898
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 04 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 4 --lrExpF 1"

# 1500
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 03 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-1 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 4 --lrExpF 1"


# ================================ Copy ===================================#
# ->4 tasks egendary-snake-914 /data/users/agomezvi/gd_pfr/tiny_imagenet_copyOP_tiny_epochs-01312023_132751_369195
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 4 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-01302023_093426_466285/ --loadTask1"
# 4 tasks - 1000 ret first tasks - luminous-goat-948
# virtuous-laughter-957
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 4 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-01302023_093426_466285/ --loadTask1"
# continue on task 1 abundant-dragon-1000 [38.1, 38.33, 39.37, 39.629999999999995]
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOP --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 4 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_copyOP_tiny_epochs-02012023_160206_673130/ --loadTask1"

# ================================ D2E ===================================#
# ->4 tasks virtuous-dumpling-917
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOP --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048  --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 4 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-01302023_093426_466285/ --loadTask1"

# ================================ Eval ===================================#
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 11 --exp_name tiny_epochs  --sslModel BT --head_classifier_lr 5e-3 --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach evalCopyOP  --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog  --expertArch ResNet18  --task1_nepochs 500   --linearProj 3 --linearProjRet 4 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_copyOP_tiny_epochs-01312023_132751_369195/ --loadTask1 --loadExpert"

# ================================ Multi GPU ===================================#
# ->4 tasks - lunar-fireworks-1033
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 11 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOPmulti --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 4 --lrExpF 1"
# ->4 tasks - both projectors 3 incandescent-fish-1043
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 12 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOPmulti --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 3 --lrExpF 1"
# 10 tasks vibrant-wonton-1046
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 13 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOPmulti --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 3 --lrExpF 1"
# 10 task x3 ret - glorious-snowflake-1059
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 13 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOPmulti --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 3 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_copyOPmulti_tiny_epochs-02042023_100052_283417/ --loadTask1"

#  4 tasks - continua after t1 -1054
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 12 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOPmulti --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 3 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_copyOPmulti_tiny_epochs-02042023_094636_319055/ --loadTask1"
# celestial-puddle-1076 [38.5, 38.84, 39.129999999999995] - 500 5e-1 [37.63, 39.44, 40.160000000000004, 40.949999999999996]
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 12 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 1000 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach copyOPmulti --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048 --trans_nepochs 0 --wandblog   --expertArch ResNet18  --task1_nepochs 1500   --linearProj 3 --linearProjRet 3 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_copyOPmulti_tiny_epochs-02042023_094636_319055/ --loadTask1"


# ================================ Multi GPU D2E===================================#
# 10 task 500 ret quiet-butterfly-1291 @103
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 500 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# 10 task 1000  fiery-mountain-1296 @103
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 500 --ret_nepochs 1000 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# 20 tasks 500 ret distinctive-water-1294 @106
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 500 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# 20 tasks 500 ret  run happy-dream-1295 @106
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 500 --ret_nepochs 1000 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"

# From task 2 normalizing BT loss radiant-durian-1361
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 03 --exp_name tiny_epochs --norm --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 500 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 2  --lr_factor 15 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-02182023_121011_941233/ --loadTask1 --multiGPU"


# 10 task 500 ret same as PFR flowing-rain-1542
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --nepochs 250 --ret_nepochs 500 --task1_Retnepochs 500 --task1_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"


## Redooo distillation t1
# 10 tasks 500 ret
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 500 --nepochs 500 --ret_nepochs 0 --trans_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --pathModelT1 /data/users/agomezvi/GD_PFR/tiny/tiny_imagenet_d2eOPscratch_tiny_epochs-02182023_120006_159733/ --loadTask1 --multiGPU"

## Redooo distillation D2E - silver-sunset-1328
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 3  --lr_factor 15 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --pathModelT1 /data/users/agomezvi/GD_PFR/tiny/ --loadTask1 --multiGPU"


# FT soft-dew-1357
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 11 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 500 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 3  --lr_factor 15 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"

# From task 2 normalizing BT loss sage-snowflake-1362
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --norm --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 500 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 2  --lr_factor 15 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-02212023_135755_853615/ --loadTask1 --multiGPU"


# From task 4 quiet-butterfly-1358
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs  --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 500 --ret_nepochs 1000 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 500 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 2  --lr_factor 15 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-02212023_135755_853615/ --loadTask1 --loadExpert --multiGPU"

# 20 task norm fiery-cloud-1370
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs  --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 500 --ret_nepochs 1000 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 500 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 2  --lr_factor 15 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1  --multiGPU"

# Tiny more batch size 1024 - apricot-sound-1531
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --norm --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 1024  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 500 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 2  --lr_factor 15 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-02212023_135755_853615/ --loadTask1 --multiGPU"

# Test DPP
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 500 --nepochs 500 --ret_nepochs 0 --trans_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratchDP --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"


# ========================== Tiny paper !=======================================#
#10 tasks # repeat @106  snowy-capybara-1665
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 500 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# repeat @106  snowy-capybara-1665
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 500 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"


### 10 tasks upbeat-morning-1678
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-02282023_115019_326092/ --loadTask1"
# Redo 1000 epochs first retrospection - glad-dust-1769 /data/users/agomezvi/GD_PFR/tiny_imagenet_d2eOPscratch_tiny_epochs-03022023_114013_763234
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# Second run --seed 425 amber-sky-2146
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 425 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# third run --seed 145
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 145 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"


### 20 tasks stellar-armadillo-1701
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 500 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# continuation - silvery-spaceship-1756-  /data/users/agomezvi/GD_PFR/tiny_imagenet_d2eOPscratch_tiny_epochs-03022023_103856_255061
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 500 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU --pathModelT1 /data/users/agomezvi/GD_PFR/tiny_imagenet_d2eOPscratch_tiny_epochs-02282023_195653_724467/ --loadTask1 --loadExpert"
# repeat 1000 epochs trans first epoch crimson-smoke-1794 @103 /data/users/agomezvi/GD_PFR/tiny_imagenet_d2eOPscratch_tiny_epochs-03032023_095215_718637
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# Second run --seed 425 chocolate-flambee-2109
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs  --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 425 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# Third run --seed 145 mocha-flambee-2110
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 03 --exp_name tiny_epochs  --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 145 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"


### 50 tasks cerulean-darkness-1847@106
#continue playful-cosmos-1877 @112
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --beginAtTask 2 --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-03042023_095855_661201/ --loadTask1"
# continue @106:/data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-03062023_210215_531389
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --beginAtTask 25 --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-03042023_193338_063785/ --loadTask1"
# Second run --seed 425 blooming-fog-2093
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs  --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 50 --seed 425 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# Third run --seed 145 cosmic-salad-2094
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 03 --exp_name tiny_epochs  --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 1000 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 50 --seed 145 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"


# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 500 --nepochs 250 --ret_nepochs 500 --trans_nepochs 500 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"


# ================================ FtOP ================================#
# 10 tasks @106
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp _name PFR_epochs --beginAtTask 1 --lambdapRet 1 --lambdaExp 1 --nepochs 500 --ret_nepochs 500  --sslModel BT --datasets tiny_imagenet --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach FtOP  --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048 --dataset2 tiny --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --task1_Retnepochs 1000 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU --pathModelT1 /data/users/agomezvi/GD_PFR/Tiny/D2E/ --loadTask1"



## ===================== FT paper ==================================#
# 10 tasks @106:copper-leaf-2071 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-03072023_210132_257483
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 17 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 500 --ret_nepochs 0 --trans_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"

# 20 tasks @local: wise-cloud-2067
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 500 --ret_nepochs 0 --trans_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# 50 tasks @112:effortless-wildflower-2072 | @106:deep-glade-2076
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 500 --ret_nepochs 0 --trans_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"

# 20 @112:eternal-cherry-2082
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 500 --ret_nepochs 0 --trans_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 256  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 0 --nepochs 1 --ret_nepochs 0 --trans_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 1 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 2 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratch --head_classifier_lr 5e-1  --lr_factor 2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  --task1_nepochs 1 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"



# ================================ Get Taw ===================================#
# --eval_fresh_head
# --eval_omni_head
# FAST_LOCAL_TEST_ARGS = "--gpu 0  --port 13 --exp_name PFR_epochs --eval_omni_head --head_classifier_lr 50 --classifier_nepochs 500 --lr_factor 50 --sslModel BT --datasets tiny_imagenet --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --hidden_mlp 512 --jitter_strength 0.5  --lr_min 5e-7   --kd_method L2  --approach evalOmnihead --projectorArc 2048_2048_2048 --wandblog   --expertArch ResNet18 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-03112023_084915_315670/ --loadTask1 --loadExpert --linearProj 3 --lrExpF 1  --dataset2 tiny"

# FAST_LOCAL_TEST_ARGS = "--gpu 0  --port 13 --exp_name PFR_epochs --eval_omni_head --head_classifier_lr 1 --classifier_nepochs 500 --lr_factor 15 --lr_patience 2 --sslModel BT --datasets tiny_imagenet --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --hidden_mlp 512 --jitter_strength 0.5  --lr_min 5e-7   --kd_method L2  --approach evalOmnihead --projectorArc 2048_2048_2048 --wandblog   --expertArch ResNet18 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-03062023_210215_531389/ --loadTask1 --loadExpert --linearProj 3 --lrExpF 1  --dataset2 tiny"
# FAST_LOCAL_TEST_ARGS = "--gpu 0  --port 13 --exp_name PFR_epochs --eval_omni_head --head_classifier_lr 5e-1 --classifier_nepochs 500 --lr_factor 3 --sslModel BT --datasets tiny_imagenet --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --hidden_mlp 512 --jitter_strength 0.5  --lr_min 5e-7   --kd_method L2  --approach evalOmnihead --projectorArc 2048_2048_2048 --wandblog   --expertArch ResNet18 --pathModelT1 /data/users/agomezvi/gd_pfr/tiny_imagenet_d2eOPscratch_tiny_epochs-03062023_210215_531389/ --loadTask1 --loadExpert --linearProj 3 --lrExpF 1  --dataset2 tiny"


FAST_LOCAL_TEST_ARGS = "--gpu 0  --port 13 --exp_name PFR_epochs --eval_omni_head  --head_classifier_lr 5e-3 --classifier_nepochs 500 --lr_factor 3 --lr_patience 20 --sslModel BT --datasets tiny_imagenet --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --hidden_mlp 512 --jitter_strength 0.5  --lr_min 5e-7   --kd_method L2  --approach evalOmniheadTiny --projectorArc 2048_2048_2048 --wandblog   --expertArch ResNet18 --pathModelT1 /data/users/agomezvi/GD_PFR/tiny_imagenet_pfr_PFR_tiny_10task-08112023_161902_564450/model-task_9.ckpt --loadTask1 --loadExpert --linearProj 3 --lrExpF 1  --dataset2 tiny"
# FAST_LOCAL_TEST_ARGS = "--gpu 0  --port 13 --exp_name PFR_epochs --eval_omni_head  --head_classifier_lr 5e-3 --classifier_nepochs 1000 --lr_factor 3 --lr_patience 20 --sslModel BT --datasets tiny_imagenet --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --hidden_mlp 512 --jitter_strength 0.5  --lr_min 5e-7   --kd_method L2  --approach evalOmniheadTiny --projectorArc 2048_2048_2048 --wandblog   --expertArch ResNet18 --pathModelT1 /data/users/agomezvi/cassle/experiments/2023_05_09_15_28_07-barlow-tiny-4T/qni2j8r8/main-task9-ep=499-qni2j8r8.ckpt --loadTask1 --loadExpert --linearProj 3 --lrExpF 1  --dataset2 tiny"


# Test DPP
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name tiny_epochs --lambdapRet 1 --lambdaExp 1 --task1_Retnepochs 500 --nepochs 500 --ret_nepochs 0 --trans_nepochs 0 --sslModel BT --datasets tiny_imagenet --dataset2 tiny --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method L2  --approach d2eOPscratchDP --head_classifier_lr 5e-2 --projectorArc 2048_2048_2048  --wandblog  --expertArch ResNet18  ocgieb84/main-task0-ep=0-ocgieb84.ckpt --task1_nepochs 10 --linearProj 3 --linearProjRet 3 --lrExpF 1 --multiGPU"



#--evalExpert
def test_simsiam():
    args_line = FAST_LOCAL_TEST_ARGS
    #run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi')#112
    # run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi/gd_pfr')  # 106
    run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi/GD_PFR')  # 103
    # run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi')  # 112
    # run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi/miniconda3/')  # 138
    # run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi/')  # 139
    # run_main_and_assert(args_line, 0, 0, result_dir='/home/agomezvi/Desktop/tempGD')  # Local
