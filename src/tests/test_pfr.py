from tests import run_main_and_assert

### R18
# 4 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name PFR_100tasks --lambdapRet 7  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 10 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 03 --exp_name PFR_10tasks --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 20 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 13 --exp_name PFR_20tasks --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 50 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 13 --exp_name PFR_50tasks --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 100 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 13 --exp_name PFR_100tasks --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 100 --seed 667 --batch_size 450  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "

### R9
# 4 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name PFR_R9_4tasks --lambdapRet 0  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 1 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method ft  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 4 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name PFR_R9_4tasks --lambdapRet 7  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 4 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 10 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name PFR_R9_10tasks --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 10 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 20 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 03 --exp_name PFR_R9_20tasks --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 20 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 50 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 04 --exp_name PFR_R9_50tasks --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 50 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 100 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 05 --exp_name PFR_R9_50tasks --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 100 --seed 667 --batch_size 450  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "


# FT
### R9
# 1 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name PFR_R9_4tasks --lambdapRet 0  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 1 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method ft  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 4 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name PFR_R9_4tasks --lambdapRet 0  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 4 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 10 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name PFR_R9_10tasks --lambdapRet 0  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 10 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 20 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 03 --exp_name PFR_R9_20tasks --lambdapRet 0  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 20 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 50 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 04 --exp_name PFR_R9_50tasks --lambdapRet 0  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 50 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 100 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 05 --exp_name PFR_R9_50tasks --lambdapRet 0  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 100 --seed 667 --batch_size 450  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet9 --mainArch ResNet9 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "


# Joints for analysis
# 4 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 10 --exp_name joint_4tasks --joint --lambdapRet 0 --reInit --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 4 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method ft  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 10 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 11 --exp_name PFR_R9_4tasks --join --lambdapRet 0 --reInit --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 10 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# 50 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 11 --exp_name PFR_R9_4tasks --join --lambdapRet 0 --reInit --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 50 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "


# Learning trajectories
### R18
####### 4 tasks
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name PFR_4tasks_trajectories --lambdapRet 7  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --loadTask1 --pathModelT1 /data/users/agomezvi/GD_PFR/cifar100_noTrans_pfr_joint_4tasks-05052023_133927_429271/"
# joint
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 10 --exp_name joint_4tasks --joint --lambdapRet 0 --reInit --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 4 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method ft  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --loadTask1 --pathModelT1 /data/users/agomezvi/GD_PFR/cifar100_noTrans_pfr_joint_4tasks-05052023_133927_429271/"

# Several lambdas
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name PFR_4tasks_trajectories --lambdapRet 15  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --loadTask1 --pathModelT1 /data/users/agomezvi/miniconda3/4_tasks/pocon/ --multiGPU"
# lamda 30
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name PFR_4tasks_trajectories --lambdapRet 30  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --loadTask1 --pathModelT1 /data/users/agomezvi/miniconda3/4_tasks/pocon/ --multiGPU"
# lamda 60
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name PFR_4tasks_trajectories --lambdapRet 60  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 4 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --loadTask1 --pathModelT1 /data/users/agomezvi/pocon/ --multiGPU"



###### 10 tasks
# Joint - /data/users/agomezvi/cifar100_noTrans_pfr_joint_10tasks-05122023_121114_733950
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 10 --exp_name joint_10tasks --joint --lambdapRet 0 --reInit --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 10 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method ft  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
# PFR /data/users/agomezvi/cifar100_noTrans_pfr_PFR_10tasks_trajectories-05122023_174249_444383 -- /data/users/agomezvi/cifar100_noTrans_pfr_PFR_10tasks_trajectories-05132023_065512_823533
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 11 --exp_name PFR_10tasks_trajectories --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 10 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --loadTask1 --pathModelT1 /data/users/agomezvi/cifar100_noTrans_pfr_joint_10tasks-05122023_121114_733950/"

###### 20 tasks
# Joint /data/users/agomezvi/cifar100_noTrans_pfr_joint_20tasks-05132023_061851_630235
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 10 --exp_name joint_20tasks --joint --lambdapRet 0 --reInit --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 20 --seed 667 --batch_size 500  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method ft  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 "
#pfr
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 11 --exp_name PFR_10tasks_trajectories --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1  --multiGPU"



# increasing stability of PFR
#lambda 0.3 frosty-resonance-3002
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 01 --exp_name PFR_20tasks_stability_l03 --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1  --multiGPU"
# #lambda 1 skilled-terrain-3004
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 02 --exp_name PFR_20tasks_stability_l1 --lambdapRet 1  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1  --multiGPU"
# #lamda 3  wobbly-shape-3005
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 03 --exp_name PFR_20tasks_stability_l3 --lambdapRet 3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1  --multiGPU"
# #lamda 10 rural-frog-3006
FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 04 --exp_name PFR_20tasks_stability_l10 --lambdapRet 10  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 20 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1  --multiGPU"


######50 tasks
#pfr
# FAST_LOCAL_TEST_ARGS = "--gpu 0 --port 11 --exp_name PFR_10tasks_trajectories --lambdapRet 0.3  --nepochs 500 --sslModel BT --datasets cifar100_noTrans --network resnet18 --num_tasks 50 --seed 667 --batch_size 512  --optim_name sgd --lr 0.01 --momentum 0.9 --weight_decay 0.0001 --num_workers 4 --classifier_nepochs 200 --hidden_mlp 512 --jitter_strength 0.5 --lr_patience 20 --lr_min 5e-7 --eval_omni_head   --kd_method pfr  --approach pfr --head_classifier_lr 5e-3 --projectorArc 2048_2048_2048 --dataset2 cifar100 --wandblog  --expertArch ResNet18 --mainArch ResNet18 --task1_nepochs 500 --linearProj 3 --linearProjRet 3 --lrExpF 1 --loadTask1 --pathModelT1 /data/users/agomezvi/GD_PFR/ --multiGPU"


def test_simsiam():
    args_line = FAST_LOCAL_TEST_ARGS
    #run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi')#112
    # run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi/gd_pfr')  # 106
    run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi/GD_PFR')  # 103
    # run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi/GD_PFR')  # 139
    # run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi/')  # 112
    # run_main_and_assert(args_line, 0, 0, result_dir='/data/users/agomezvi/miniconda3/')  # 138
    # run_main_and_assert(args_line, 0, 0, result_dir='/home/agomezvi/D
    # esktop/tempGD')  # Local